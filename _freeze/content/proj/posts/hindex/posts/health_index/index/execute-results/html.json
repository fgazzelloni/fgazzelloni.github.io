{
  "hash": "04ce6d462935aa7b2b6a5f440551f794",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Health Index\"\nexcerpt: \"Machine learning models\"\ndate: 2025-11-01\ndraft: false\nimages:\nseries:\ncategories: \n  - Health\n  - Health Index\nlayout: single\npage-layout: full\nexecute: \n  eval: false\n---\n\n\n## Overview\n\n:::: columns\n::: {.column width=\"80%\"}\nProcess of building an index to show the dimension of health with an index. Data used is the life expectancy at birth data from the IHME GBD 2021 **Global Burden of Disease Study 2021 (GBD 2021) Mortality and Life Expectancy Forecasts 2022-2050** dataset.\n:::\n\n::: {.column width=\"20%\"}\n![](featured.png)\n:::\n::::\n\n \n\nsource: <https://ghdx.healthdata.org/record/ihme-data/global-life-expectancy-all-cause-mortality-and-cause-specific-mortality-forecasts-2022-2050> you'll need to login for accessing the data.\n\n### Load Libraries and Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(stringr)\nlibrary(readxl)\n```\n:::\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nraw_le2022 <- read_excel(\"data/IHME_GBD_2021_MORT_LE_FORECASTS_2022_2050_TABLES_0/le.XLSX\",skip = 1)\nhead(raw_le2022)\n```\n:::\n\n\n### Reference scenario life expectancy at birth 2022 \n\n#### Female le data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfemale_le2022 <- raw_le2022$`Reference scenario life expectancy at birth` %>%\n  str_replace_all(\"·\", \".\") %>%     \n  str_extract_all(\"\\\\d+\\\\.?\\\\d*\", simplify = TRUE)\n```\n:::\n\n\n\n#### Locations\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_name <- raw_le2022$...1\n```\n:::\n\n\n#### Build data frame\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfemale_le2022 <- data.frame(location_name,female_le2022) %>%\n  select(location_name, le = X1) %>%\n  mutate(le = as.numeric(le),\n         sex=\"female\") %>%\n  drop_na()\n\nfemale_le2022\n```\n:::\n\n\n#### Male le data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmale_le2022 <- raw_le2022$...5 %>%\n  str_replace_all(\"·\", \".\") %>%     \n  str_extract_all(\"\\\\d+\\\\.?\\\\d*\", simplify = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmale_le2022 <- data.frame(location_name,male_le2022) %>%\n  select(location_name, le = X1) %>%\n  mutate(le = as.numeric(le),\n         sex=\"male\") %>%\n  drop_na()\n\nmale_le2022\n```\n:::\n\n\n### Combine female and male le\n\n\n::: {.cell}\n\n```{.r .cell-code}\nle2022_data <- bind_rows(female_le2022,male_le2022) %>%\n  group_by(location_name) %>%\n  reframe(le_avg2022=round(mean(le)))%>%\n  distinct()\n\nle2022_data%>%head\n```\n:::\n\n\n\n\n#### HALE data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nraw_le_hale2022 <- read_excel(\"data/IHME_GBD_2021_MORT_LE_FORECASTS_2022_2050_TABLES_0/le_hale.XLSX\")\nhead(raw_le_hale2022)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlocation_name <- raw_le_hale2022$`Supplemental Results Table S2. Life expectancy and healthy life expectancy (HALE) in 2022 and 2050 (reference scenario) by location for both sexes. Estimates are listed as means with 95% uncertainty intervals in parentheses. Highlighted rows indicate region and super region results from the GBD location hierarchy.`\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhale2022 <- raw_le_hale2022$...5%>%\n  str_replace_all(\"·\", \".\") %>%      \n  str_extract_all(\"\\\\d+\\\\.?\\\\d*\", simplify = TRUE)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhale2022 <- data.frame(location_name,hale2022) %>%\n  select(location_name, hale = X1) %>%\n  mutate(hale = as.numeric(hale)) %>%\n  drop_na()%>%\n  distinct()\n\nhale2022\n```\n:::\n\n\n\n#### From results healthdata website yll and yld by age standardized\n\n::: {.cell}\n\n```{.r .cell-code}\nyll_yld2022_raw <- hmsidwR::getunz(\"https://dl.healthdata.org:443/gbd-api-2023-public/7bae287bc4f06482be6332f797f3ebc2_files/IHME-GBD_2023_DATA-7bae287b-1.zip\")\n\nyll_yld2022 <- yll_yld2022_raw[[1]] %>% \n  select(location_name=location,\n         measure,val)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyld2022_data <- yll_yld2022%>%\n  filter(measure==\"YLDs (Years Lived with Disability)\")%>%\n  rename(yld=val)%>%\n  select(-measure) %>%\n  distinct()\nyll2022_data <- yll_yld2022%>%\n  filter(measure==\"YLLs (Years of Life Lost)\")%>%\n  rename(yll=val)%>%\n  select(-measure) %>%\n  distinct()\n  \nyll_yld2022_data<- merge(yld2022_data,yll2022_data)\n```\n:::\n\n\n\n### Combine all data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindex_data2022 <- le2022_data %>%\n  left_join(hale2022, by=\"location_name\") %>%\n  left_join(yll_yld2022_data ,by=\"location_name\") %>%\n  drop_na()\n```\n:::\n\n\nthe dimension index is calculated as:\n\n$$\n\\text{dimension index} = \\frac{\\alpha\\text{le} + (1-\\alpha)\\text{hale}}{(1-\\hat{yll}) + (1-\\hat{yld})} * 100\n$$\nwhere scaled yll and scaled yld are the standardized values of yll and yld respectively.\n\nIn literature a dimension index is used to measure the quality of life in a location, taking into account not only life expectancy but also the burden of disease and disability.\n\nIn particular, the dimension index combines life expectancy at birth (le_avg2022) and healthy life expectancy (hale) in the numerator, reflecting both the quantity and quality of life. The denominator incorporates the scaled values of years of life lost (yll) and years lived with disability (yld), which represent the burden of disease and disability in the population.\n\nParticular attention is put on the values of yll and yld, which are scaled to ensure comparability across different locations. The scaling process standardizes these values, allowing for a more accurate assessment of the overall health status of the population.\n\nfor reference see:\n\n- <https://www.frontiersin.org/journals/public-health/articles/10.3389/fpubh.2025.1566469/full>\n- <https://pmc.ncbi.nlm.nih.gov/articles/PMC4140376/>\n\n\nscale between 0 and 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# scale <- function(x){\n#   (x - min(x)) / (max(x) - min(x))\n# }\n# \n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindex_data2022%>%summary()\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindex_data2022%>%\n  filter(is.na(yll) | is.na(yld))\n```\n:::\n\n?scale\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindex_data2022%>%\n  mutate(yll_scaled=scale(yll,center = F),\n         yld_scaled=scale(yld,center = F)) %>%\n  mutate(dimension_index = round((le_avg2022 + hale)/((1-yll_scaled) + (1-yld_scaled))*100,2),\n         .after=location_name) \n```\n:::\n\n\n$$\nhealth_dim_index = (LE_scaled + HALE_scaled + (1 - YLL_scaled) + (1 - YLD_scaled)) / 4\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindex_data2022 %>%\n  mutate(across(where(is.numeric), ~ as.numeric(scale(.x, center = F)),\n                .names = \"{.col}_scaled\")) %>%\n  mutate(dimension_index = round((le_avg2022 + hale)/((1-yll_scaled) + (1-yld_scaled))*100,2),\n         dimension_index2 = round((le_avg2022_scaled + hale_scaled + (1-yll_scaled) + (1-yld_scaled))/4,2),\n         dimension_index3 = round(((le_avg2022_scaled + hale_scaled)/ ((1-yll_scaled) + (1-yld_scaled))/2)*100,2),\n         dimension_index3_geo=((le_avg2022 + hale)/(((1-yll_scaled)+(1-yld_scaled))/2))^(1/4) *100,\n         .after=location_name) %>%\n  filter(is.na(dimension_index3_geo))\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}