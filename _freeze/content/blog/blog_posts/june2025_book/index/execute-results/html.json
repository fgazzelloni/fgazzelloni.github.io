{
  "hash": "bebf2366d51bc892b95a7eda2586a44d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Writing a book in R\"\ndate: '2025-06-23'\nimage: featured.png\nslug: writing-a-book-in-r\ncategories:\n  - book\nsummary: \"My Book Writing Journey\"\nexecute: \n  eval: false\n---\n\n## Overview\n\n::::: columns\n::: {.column width=“60%”}\nIn this post, I share my experience of writing a book entirely in R, and the challenges I faced along the way. I walk through the tools I used, the workflow I followed, and the lessons I learned while preparing a full-length technical book supported by datasets, code, and reproducible examples.\n\nIt has been an incredible journey. Now that the book is fully published, I feel both the excitement of sharing it with readers and a sense that a long creative process has reached its conclusion.\n\nBelow, I explain how I structured the book, organised the code, automated the rendering, and ensured the material remained reproducible from the first draft to the final version.\n:::\n\n::: {.column width=\"40%\"}\n![HMSIDr Book](featured.png)\n:::\n:::::\n\n\n\n## Setting Up the Project\n\nI started by creating a dedicated RStudio project. Keeping the book isolated in its own project was essential for reproducibility, file organisation, and version control.\n\nCreate a new book project structure\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::create_project(\"hmsid-book\")\n```\n:::\n\n\nSet up a Git repository to track changes:\n\n::: {.cell}\n\n```{.r .cell-code}\n# Initialise git\n`usethis::use_git()`\n```\n:::\n\n\n\nThen I added a basic `Quarto/bookdown` structure:\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto::quarto_create(\"hmsidwR\", template = \"book\")\n```\n:::\n\n\nThis generated the `_quarto.yml` file, a structure for chapters, and a place for images and data.\n\nA minimal `_quarto.yml` looked like this:\n\n:::{.callout-note appearance=\"simple\"}\n\n::: {.cell}\n\n```{.r .cell-code}\nproject:\n  type: book\n\nbook:\n  title: \"Health Metrics and the Spread of Infectious Diseases\"\n  author: \"Federica Gazzelloni\"\n  chapters:\n    - index.qmd\n    - 01_introduction.qmd\n    - 02_data.qmd\n    - 03_methods.qmd\n    - 04_modeling.qmd\n    - 05_spatial_analysis.qmd\n    - 06_results.qmd\n    - 07_conclusions.qmd\n\nformat:\n  html:\n    theme: cosmo\n  pdf:\n    documentclass: scrreprt\n```\n:::\n\n:::    \n\n## Managing Data Inside an R Package\n\nTo keep the workflow clean and reproducible, I organised all datasets into a companion R package (`{hmsidwR}`). This meant readers could reproduce every example with:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ninstall.packages(\"hmsidwR\")\nlibrary(hmsidwR)\n```\n:::\n\n\n\nLoading a dataset was as simple as:\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"infectious_diseases\")\nhead(infectious_diseases)\n```\n:::\n\n\n\nPackaging the data required a few lines in the development workflow:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_data(tb_data, overwrite = TRUE)\n```\n:::\n\n\nThis approach saved hours of manual file handling in later stages of writing.\n\n## Writing Chapters with Embedded Code\n\nMost chapters combined narrative text with code chunks. A typical section looked like this:\n\n## Life Expectancy Trends\n\nWe begin by exploring changes in life expectancy across countries.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(hmsidwR)\nset.seed=04122025\nhmsidwR::gho_le_hale %>%\n  filter(indicator==\"Life expectancy at birth (years)\",\n         sex==\"both sexes\") %>%\n  group_by(region, year) %>%\n  reframe(le=mean(value, na.rm=TRUE)) %>%\n  ggplot(aes(year, le, \n             colour = region)) +\n  geomtextpath::geom_textline(aes(label = region), \n                              position = \"jitter\",\n                              orientation = \"x\",\n                              hjust=0,size=3,\n                              show.legend = F) +\n  ggthemes::scale_color_economist()+\n  labs(title = \"Life Expectancy Over Time\",\n       x=\"Time(year)\",\n       y=\"Life expectancy at birth (years)\")+\n  theme_minimal(base_size = 14, \n                base_rect_size = 0.2,\n                base_line_size = 1,\n                accent = \"red\",ink = \"grey25\") +\n  theme(text=element_text(face=\"bold\"),\n        axis.title = element_text(size=9))\n```\n:::\n\n\n\n::: {.cell}\n\n:::\n\n\n![Regions' Life Expectancy Over Time](images/le.png){#fig-le fig-alt=\"Regions' le\" fig-align=\"center\" width=\"80%\"}\n\nKeeping all figures generated directly from the code ensured:\n\n- No manual image editing\n- Fully up-to-date plots on each render\n- Transparent modelling steps\n\n# Automating Rendering\n\nWith dozens of chapters and hundreds of figures, manual rendering was not feasible. I automated it using one command:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto::quarto_render()\n```\n:::\n\n\n\nFor more granular control (helpful when writing new sections):\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto::quarto_render(\"03_methods.qmd\")   # render a single chapter\n```\n:::\n\n\n\n\nBefore shipping the final manuscript, I used a clean render:\n\n::: {.cell}\n\n```{.r .cell-code}\nquarto::quarto_clean()\nquarto::quarto_render()\n```\n:::\n\n\nThis guaranteed that everything knitted from scratch.\n\n## Version Control and Collaboration\n\nGit and GitHub supported the entire project:\n\n::: {.cell}\n\n```{.r .cell-code}\nusethis::use_github()\n```\n:::\n\n\n\n\nEach chapter was committed incrementally:\n\n      git add 03_methods.qmd\n      git commit -m \"Expand description of spatial interpolation\"\n      git push\n\nVersion control helped keep track of:\n- structure revisions\n- code changes\n- feedback from early readers\n- chapter reorganisations\n\nDesigning Figures and Reproducible Maps\n\nSpatial chapters required more complex workflows. For example:\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(sf)\nlibrary(terra)\nlibrary(tmap)\n\nworld <- vect(hmsidwR::idDALY_map_data)\ntb <- hmsidwR::idDALY_map_data\n\ntm_shape(world) +\n  tm_borders(fill=\"grey90\",lwd=0.5) +\n  tm_shape(tb) +\n  tm_dots(col = \"DALYs\", \n          shape=21,lwd = 0.1,\n          palette = \"matplotlib.reds\") +\n  tm_layout(frame = FALSE)\n```\n:::\n\n\n![Dalys](images/dalys.png)\n\n\n\nEvery map in the book was generated this way, ensuring readers could run the exact same code.\n\n## Lessons Learned\n\nWriting a technical book is both exciting and demanding. I dedicated countless hours to selecting the right material and presenting it in a way that early-career researchers could follow. One of the most difficult decisions was choosing what to include and what to leave out, always aiming for clarity over completeness.\n\nEven now that the book is published, ideas continue to appear. There is always the thought of adding more material, improving explanations, or strengthening examples. At some point, you must trust the work and release it.\n\nI am grateful for all the support I received throughout this process. The conversations, reviews, and early feedback played a key role in shaping the final version.\n\n## What’s Next?\n\nAlthough this project is complete, my writing plans certainly are not. I will continue developing extensions, datasets, and methodological notes. New projects are already emerging, and this experience has strengthened my commitment to open, reproducible, and accessible research.\n\nFor now, I invite you to explore the book, use the examples, and share your thoughts. Your insights will help me shape future work and teaching material.\n\n> *\"Thank you for following this journey.\"*\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}